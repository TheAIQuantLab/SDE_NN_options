# Stochastic diferential equation neural netowrks for options prices models

This projects aims to train SDE NN to match the terminal distributions of options models.

**SDE-NN:**

The SDE-NN aims to learn drift ($\mu_S, \mu_Y$) and volatility ($\sigma_S, \sigma_Y$) functions for a two-factor stochastic process $(S_t, Y_t)$ using a neural network. The learned SDE system is:

$$
\begin{aligned}
dS_t &= \mu_S(S_t, Y_t; \theta) S_t dt + \sigma_S(S_t, Y_t; \theta) S_t dW_t \\
dY_t &= \mu_Y(S_t, Y_t; \theta) dt + \sigma_Y(S_t, Y_t; \theta) dZ_t
\end{aligned}
$$

Here, $\mu_S, \sigma_S, \mu_Y, \sigma_Y$ are determined by the `SDENN` network (with parameters $\theta$) based on the current states $S_t$ and $Y_t$. The network outputs `[mu_S, log_sigma_S, mu_Y, log_sigma_Y]`, and the volatilities are obtained by exponentiation ($\sigma = \exp(\text{log\_sigma})$). $W_t$ and $Z_t$ are correlated Brownian motions in the `simulate_sdenn` function. The training process involves adjusting the network's parameters to minimize the Wasserstein distance between the terminal distribution of $S_t$ generated by this learned SDE and the terminal distribution of the Heston model's asset price. The key change in this step is the adjustment of training hyperparameters (learning rate, number of paths, number of epochs) to potentially improve the learning outcome.

**Heston Model SDEs:**

The Heston model defines the asset price $S_t$ and its variance $v_t$ via:

$$
\begin{aligned}
dS_t &= r S_t dt + \sqrt{v_t} S_t dW_t \\
dv_t &= \kappa (\theta - v_t) dt + \sigma \sqrt{v_t} dZ_t
\end{aligned}
$$

where $W_t$ and $Z_t$ are correlated Brownian motions. The idea is to be able to model this dynamics with the NN.
